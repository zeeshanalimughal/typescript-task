<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
</head>
<body>
    <div id="tree-div">

    </div>
</body>
</html>

<script>
const lines = [
    [1, "Mark Zuckerberg"],
    [2, "Sarah Donald", 1],
    [3, "Cassandra Reynolds", 2],
    [4, "Mary Blue", 3],
    [5, "Bob Saget", 3],
    [7, "Will Turner", 6],
    [6, "Tina Teff", 5],
    [9, "Harry Tobs", 8],
    [10, "Thomas Brown", 9],
    [8, "Tyler Simpson", 1],
    [11, "George Carrey", 8],
    [12, "Gary Styles", 8],
    [13, "Bruce Willis", 1],
    [14, "Georgina Flangy", 1],
    [15, "Sophie Turner", 14]
  ];


let treeDiv = document.getElementById('tree-div');

lines.sort((line1, line2) => {
    return line1[0] - line2[0];
}).forEach(line => addNode(line));

console.log(lines);

function addNode(employee) {
    let div = document.createElement('div');
    let root = null;
    div.dataset.id = employee[0];
    div.classList = 'node';
    div.innerText = employee[1];
    div.style.height = '25px';
    div.style.lineHeight = '25px';

    if (employee[2]) {
        div.dataset.parentId = employee[2];
        let depth = parseInt(document.querySelector(
            `div[data-id="${div.dataset.parentId}"]`
            ).dataset.depth);
        div.dataset.depth = depth + 1
        div.style.paddingLeft = 20 * (depth + 1) + 'px';
        
    } else {
        div.dataset.depth = '0';
    }

    treeDiv.appendChild(div);
}

let nodes = document.querySelectorAll('.node');
let initX, initY, prevX, prevY, currentX, currentY;

nodes.forEach(node => {
    node.addEventListener('mousedown', function(e) {

        e.preventDefault();
        initX = this.offsetLeft;
        initY = this.offsetTop;
        prevX = document.pageX;
        prevY = document.pageY;

        this.style.backgroundColor = 'blue';

        document.addEventListener('mousemove', dragIt(node), false);

        window.addEventListener('mouseup', function() {
            
            node.removeEventListener('mousemove', dragIt, false);
            node.style.position = 'static';
            node.style.backgroundColor = 'inherit';
            node.style.left = '0';
            node.style.top = '0';

        }, false);
    }, false);
});

function dragIt(e) {
    e.style.position = 'absolute';
    e.style.width = '100%';
    console.log('pageX = ', e.pageX, 'prevX = ', prevX)
    if (e.pageX - prevX >= 30) {
        prevX = document.pageX;
        e.style.paddingLeft = parseInt(e.style.paddingLeft.split('px')[0]) + 20 + 'px';
    } else if (prevX - e.pageX >= 30) {
        prevX = document.pageX;
        e.style.paddingLeft = parseInt(e.style.paddingLeft.split('px')[0]) - 20 + 'px';
    }

    if (e.pageY - prevY >= 35) {
        prevX = document.pageX;
        this.style.paddingTop = parseInt(this.style.paddingTop.split('px')[0]) + 20 + 'px';
    } else if (prevX - e.pageX >= 35) {
        prevX = document.pageX;
        this.style.paddingTop = parseInt(this.style.paddingTop.split('px')[0]) - 20 + 'px';
    }
}


</script>
